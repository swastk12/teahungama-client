{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/user/Desktop/teahungama/clients/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/user/Desktop/teahungama/clients/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\user\\\\Desktop\\\\teahungama\\\\clients\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useContext,useState}from\"react\";import\"./write.css\";import{axiosInstance}from\"../../config\";import{Context}from\"../../context/Context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Write(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useContext=useContext(Context),user=_useContext.user;var controlSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var newPost,data,filename,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc};if(!file){_context.next=24;break;}data=new FormData();filename=Date.now()+file.name;data.append(\"name\",filename);data.append(\"file\",file);newPost.photo=filename;_context.prev=8;_context.next=11;return axiosInstance.post(\"/upload\",data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.prev=15;_context.next=18;return axiosInstance.post(\"/posts\",newPost);case 18:res=_context.sent;window.location.replace(\"/post/\"+res.data._id);_context.next=24;break;case 22:_context.prev=22;_context.t1=_context[\"catch\"](15);case 24:axiosInstance.post(\"/posts\");case 25:case\"end\":return _context.stop();}}},_callee,null,[[8,13],[15,22]]);}));return function controlSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{className:\"writeImg\",src:URL.createObjectURL(file),alt:\"\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",onSubmit:controlSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeFormGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"writeIcon fas fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{id:\"fileInput\",type:\"file\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{className:\"writeInput\",placeholder:\"Title\",type:\"text\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"writeFormGroup\",children:/*#__PURE__*/_jsx(\"textarea\",{className:\"writeInput writeText\",placeholder:\"Tell your story...\",type:\"text\",autoFocus:true,onChange:function onChange(e){return setDesc(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"writeSubmit\",type:\"submit\",children:\"Publish\"})]})]});}","map":{"version":3,"sources":["C:/Users/user/Desktop/teahungama/clients/client/src/pages/write/Write.jsx"],"names":["useContext","useState","axiosInstance","Context","Write","title","setTitle","desc","setDesc","file","setFile","user","controlSubmit","e","preventDefault","newPost","username","data","FormData","filename","Date","now","name","append","photo","post","res","window","location","replace","_id","URL","createObjectURL","display","target","files","value"],"mappings":"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","sourcesContent":["import { useContext,useState } from \"react\";\r\nimport \"./write.css\";\r\nimport {axiosInstance} from \"../../config\";\r\nimport { Context } from \"../../context/Context\";\r\n\r\nexport default function Write() {\r\nconst [title, setTitle]= useState(\"\")\r\nconst [desc, setDesc]= useState(\"\")\r\nconst [file,setFile]= useState(null)\r\nconst { user } = useContext(Context);\r\n\r\nconst controlSubmit = async(e)=>{\r\ne.preventDefault();\r\nconst newPost ={\r\n  username:user.username,\r\n  title,\r\n  desc,\r\n};\r\nif(file){\r\n  const data = new FormData();\r\n  const filename = Date.now() + file.name;\r\n  data.append(\"name\", filename)\r\n  data.append(\"file\",file)\r\n  newPost.photo = filename;\r\n  try{\r\n  await axiosInstance.post(\"/upload\", data);\r\n  }catch(err){\r\n}\r\ntry{\r\n const res = await axiosInstance.post(\"/posts\", newPost);\r\n window.location.replace(\"/post/\" + res.data._id);\r\n}catch(err){\r\n\r\n}\r\n}\r\naxiosInstance.post(\"/posts\");\r\n};\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"write\">\r\n      {file && (\r\n      <img\r\n      className=\"writeImg\"\r\n      src={URL.createObjectURL(file)}\r\n      alt=\"\"\r\n    />\r\n      )}\r\n\r\n      <form className=\"writeForm\" onSubmit={controlSubmit}>\r\n        <div className=\"writeFormGroup\">\r\n          <label htmlFor=\"fileInput\">\r\n            <i className=\"writeIcon fas fa-plus\"></i>\r\n          </label>\r\n          <input id=\"fileInput\" type=\"file\" style={{ display: \"none\" }} \r\n           onChange={(e) => setFile(e.target.files[0])}\r\n          />\r\n          <input\r\n            className=\"writeInput\"\r\n            placeholder=\"Title\"\r\n            type=\"text\"\r\n            autoFocus={true}\r\n            onChange={(e) => setTitle(e.target.value)}\r\n          />\r\n        </div>\r\n        <div className=\"writeFormGroup\">\r\n          \r\n          <textarea\r\n            className=\"writeInput writeText\"\r\n            placeholder=\"Tell your story...\"\r\n            type=\"text\"\r\n            autoFocus={true}\r\n            onChange={(e) => setDesc(e.target.value)}\r\n          />\r\n        </div>\r\n        <button className=\"writeSubmit\" type=\"submit\">\r\n          Publish\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}